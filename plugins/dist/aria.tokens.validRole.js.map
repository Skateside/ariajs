{"version":3,"names":[],"mappings":"","sources":["aria.tokens.validRole.js"],"sourcesContent":["/**\r\n * @file     Adds validation that checks that the element gaining a WAI-ARIA\r\n *           attribute has the appropriate role and that a parent has an\r\n *           appropriate parent role.\r\n * @author   James \"Skateside\" Long\r\n * @license  MIT\r\n * @requires aria.tokens.js\r\n */\r\n(function (ARIA) {\r\n\r\n    \"use strict\";\r\n\r\n    /**\r\n     * A simple wrapper for Array#slice.\r\n     *\r\n     * @private\r\n     * @param   {Array|Object} arrayLike\r\n     *          Array or array-like structure to slice.\r\n     * @param   {Number} [offset]\r\n     *          Optional offset for the slice.\r\n     * @return  {Array}\r\n     *          Sliced array.\r\n     */\r\n    var slice = function (arrayLike, offset) {\r\n        return Array.prototype.slice.call(arrayLike, offset);\r\n    };\r\n\r\n    /**\r\n     * A simple fall-back for Object.assign.\r\n     *\r\n     * @private\r\n     * @param   {Object} source\r\n     *          Source object to modify.\r\n     * @param   {Object} [...objects]\r\n     *          Additional objects to extend the first.\r\n     * @return  {Object}\r\n     *          Extended object.\r\n     */\r\n    var objectAssign = Object.assign || function (source) {\r\n\r\n        slice(arguments, 1).forEach(function (object) {\r\n\r\n            if (object) {\r\n\r\n                Object.keys(object).forEach(function (key) {\r\n                    source[key] = object[key];\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n        return source;\r\n\r\n    };\r\n\r\n    if (ARIA && ARIA.tokens) {\r\n\r\n        /**\r\n         * The accepted roles for WAI-ARIA attributes. If the attribute isn't in\r\n         * this list, it is assumed that it can be used on any element.\r\n         * Each key in this object related to an object with \"used\" and\r\n         * \"inherited\" keys. \"used\" is a white-list of roles for the current\r\n         * element, \"inherited\" is a white-list of roles for parent elements.\r\n         * @type {Object}\r\n         */\r\n        ARIA.acceptedRoles = objectAssign(Object.create(null), {\r\n            \"aria-activedescendant\": {\r\n                used: [\r\n                    \"application\",\r\n                    \"composite\",\r\n                    \"group\",\r\n                    \"textbox\"\r\n                ],\r\n                inherited: [\r\n                    \"combobox\",\r\n                    \"grid\",\r\n                    \"listbox\",\r\n                    \"menu\",\r\n                    \"menubar\",\r\n                    \"radiogroup\",\r\n                    \"row\",\r\n                    \"searchbox\",\r\n                    \"select\",\r\n                    \"spinbutton\",\r\n                    \"tablist\",\r\n                    \"toolbar\",\r\n                    \"tree\",\r\n                    \"treegrid\"\r\n                ]\r\n            },\r\n            \"aria-autocomplete\": {\r\n                used: [\r\n                    \"combobox\",\r\n                    \"textbox\"\r\n                ],\r\n                inherited: [\r\n                    \"searchbox\"\r\n                ]\r\n            },\r\n            \"aria-checked\": {\r\n                used: [\r\n                    \"checkbox\",\r\n                    \"option\",\r\n                    \"radio\",\r\n                    \"switch\"\r\n                ],\r\n                inherited: [\r\n                    \"menuitemcheckbox\",\r\n                    \"menuitemradio\",\r\n                    \"treeitem\"\r\n                ]\r\n            },\r\n            \"aria-colcount\": {\r\n                used: [\r\n                    \"table\"\r\n                ],\r\n                inherited: [\r\n                    \"grid\",\r\n                    \"treegrid\"\r\n                ]\r\n            },\r\n            \"aria-colindex\": {\r\n                used: [\r\n                    \"cell\",\r\n                    \"row\"\r\n                ],\r\n                inherited: [\r\n                    \"columnheader\",\r\n                    \"gridcell\",\r\n                    \"rowheader\"\r\n                ]\r\n            },\r\n            \"aria-colspan\": {\r\n                used: [\r\n                    \"cell\"\r\n                ],\r\n                inherited: [\r\n                    \"columnheader\",\r\n                    \"gridcell\",\r\n                    \"rowheader\"\r\n                ]\r\n            },\r\n            \"aria-expanded\": {\r\n                used: [\r\n                    \"button\",\r\n                    \"combobox\",\r\n                    \"document\",\r\n                    \"link\",\r\n                    \"section\",\r\n                    \"sectionhead\",\r\n                    \"window\"\r\n                ],\r\n                inherited: [\r\n                    \"alert\",\r\n                    \"alertdialog\",\r\n                    \"article\",\r\n                    \"banner\",\r\n                    \"cell\",\r\n                    \"columnheader\",\r\n                    \"complementary\",\r\n                    \"contentinfo\",\r\n                    \"definition\",\r\n                    \"dialog\",\r\n                    \"directory\",\r\n                    \"feed\",\r\n                    \"figure\",\r\n                    \"form\",\r\n                    \"grid\",\r\n                    \"gridcell\",\r\n                    \"group\",\r\n                    \"heading\",\r\n                    \"img\",\r\n                    \"landmark\",\r\n                    \"list\",\r\n                    \"listbox\",\r\n                    \"listitem\",\r\n                    \"log\",\r\n                    \"main\",\r\n                    \"marquee\",\r\n                    \"math\",\r\n                    \"menu\",\r\n                    \"menubar\",\r\n                    \"navigation\",\r\n                    \"note\",\r\n                    \"progressbar\",\r\n                    \"radiogroup\",\r\n                    \"region\",\r\n                    \"row\",\r\n                    \"rowheader\",\r\n                    \"search\",\r\n                    \"select\",\r\n                    \"status\",\r\n                    \"tab\",\r\n                    \"table\",\r\n                    \"tabpanel\",\r\n                    \"term\",\r\n                    \"timer\",\r\n                    \"toolbar\",\r\n                    \"tooltip\",\r\n                    \"tree\",\r\n                    \"treegrid\",\r\n                    \"treeitem\"\r\n                ]\r\n            },\r\n            \"aria-level\": {\r\n                used: [\r\n                    \"grid\",\r\n                    \"heading\",\r\n                    \"row\",\r\n                    \"tablist\"\r\n                ],\r\n                inherited: [\r\n                    \"treegrid\",\r\n                    \"treeitem\"\r\n                ]\r\n            },\r\n            \"aria-modal\": {\r\n                used: [\r\n                    \"window\"\r\n                ],\r\n                inherited: [\r\n                    \"alertdialog\",\r\n                    \"dialog\"\r\n                ]\r\n            },\r\n            \"aria-multiline\": {\r\n                used: [\r\n                    \"textbox\"\r\n                ],\r\n                inherited: [\r\n                    \"searchbox\"\r\n                ]\r\n            },\r\n            \"aria-multiselectable\": {\r\n                used: [\r\n                    \"grid\",\r\n                    \"listbox\",\r\n                    \"tablist\",\r\n                    \"tree\"\r\n                ],\r\n                inherited: [\r\n                    \"treegrid\"\r\n                ]\r\n            },\r\n            \"aria-orientation\": {\r\n                used: [\r\n                    \"scrollbar\",\r\n                    \"select\",\r\n                    \"separator\",\r\n                    \"slider\",\r\n                    \"tablist\",\r\n                    \"toolbar\"\r\n                ],\r\n                inherited: [\r\n                    \"combobox\",\r\n                    \"listbox\",\r\n                    \"menu\",\r\n                    \"menubar\",\r\n                    \"radiogroup\",\r\n                    \"tree\",\r\n                    \"treegrid\"\r\n                ]\r\n            },\r\n            \"aria-placeholder\": {\r\n                used: [\r\n                    \"textbox\"\r\n                ],\r\n                inherited: [\r\n                    \"searchbox\"\r\n                ]\r\n            },\r\n            \"aria-posinset\": {\r\n                used: [\r\n                    \"article\",\r\n                    \"listitem\",\r\n                    \"menuitem\",\r\n                    \"option\",\r\n                    \"radio\",\r\n                    \"tab\"\r\n                ],\r\n                inherited: [\r\n                    \"menuitemcheckbox\",\r\n                    \"menuitemradio\",\r\n                    \"treeitem\"\r\n                ]\r\n            },\r\n            \"aria-pressed\": {\r\n                used: [\r\n                    \"button\"\r\n                ],\r\n                inherited: [\r\n                ]\r\n            },\r\n            \"aria-readonly\": {\r\n                used: [\r\n                    \"checkbox\",\r\n                    \"combobox\",\r\n                    \"grid\",\r\n                    \"gridcell\",\r\n                    \"listbox\",\r\n                    \"radiogroup\",\r\n                    \"slider\",\r\n                    \"spinbutton\",\r\n                    \"textbox\"\r\n                ],\r\n                inherited: [\r\n                    \"columnheader\",\r\n                    \"menuitemcheckbox\",\r\n                    \"menuitemradio\",\r\n                    \"rowheader\",\r\n                    \"searchbox\",\r\n                    \"switch\",\r\n                    \"treegrid\"\r\n                ]\r\n            },\r\n            \"aria-required\": {\r\n                used: [\r\n                    \"comboxbox\",\r\n                    \"gridcell\",\r\n                    \"listbox\",\r\n                    \"radiogroup\",\r\n                    \"spinbutton\",\r\n                    \"textbox\",\r\n                    \"tree\"\r\n                ],\r\n                inherited: [\r\n                    \"columnheader\",\r\n                    \"rowheader\",\r\n                    \"searchbox\",\r\n                    \"treegrid\"\r\n                ]\r\n            },\r\n            \"aria-rowcount\": {\r\n                used: [\r\n                    \"table\"\r\n                ],\r\n                inherited: [\r\n                    \"grid\",\r\n                    \"treegrid\"\r\n                ]\r\n            },\r\n            \"aria-rowindex\": {\r\n                used: [\r\n                    \"cell\",\r\n                    \"row\"\r\n                ],\r\n                inherited: [\r\n                    \"columnheader\",\r\n                    \"gridcell\",\r\n                    \"rownheader\"\r\n                ]\r\n            },\r\n            \"aria-rowspan\": {\r\n                used: [\r\n                    \"cell\"\r\n                ],\r\n                inherited: [\r\n                    \"columnheader\",\r\n                    \"gridcell\",\r\n                    \"rowheader\"\r\n                ]\r\n            },\r\n            \"aria-selected\": {\r\n                used: [\r\n                    \"gridcell\",\r\n                    \"option\",\r\n                    \"row\",\r\n                    \"tab\"\r\n                ],\r\n                inherited: [\r\n                    \"columnheader\",\r\n                    \"rowheader\",\r\n                    \"treeitem\"\r\n                ]\r\n            },\r\n            \"aria-setsize\": {\r\n                used: [\r\n                    \"article\",\r\n                    \"listitem\",\r\n                    \"menuitem\",\r\n                    \"option\",\r\n                    \"radio\",\r\n                    \"tab\"\r\n                ],\r\n                inherited: [\r\n                    \"menuitemcheckbox\",\r\n                    \"menuitemradio\",\r\n                    \"treeitem\"\r\n                ]\r\n            },\r\n            \"aria-sort\": {\r\n                used: [\r\n                    \"columnheader\",\r\n                    \"rowheader\"\r\n                ],\r\n                inherited: [\r\n                ]\r\n            },\r\n            \"aria-valuemax\": {\r\n                used: [\r\n                    \"range\",\r\n                    \"scrollbar\",\r\n                    \"separator\",\r\n                    \"slider\",\r\n                    \"spinbutton\"\r\n                ],\r\n                inherited: [\r\n                    \"progressbar\"\r\n                ]\r\n            },\r\n            \"aria-valuemin\": {\r\n                used: [\r\n                    \"range\",\r\n                    \"scrollbar\",\r\n                    \"separator\",\r\n                    \"slider\",\r\n                    \"spinbutton\"\r\n                ],\r\n                inherited: [\r\n                    \"progressbar\"\r\n                ]\r\n            },\r\n            \"aria-valuenow\": {\r\n                used: [\r\n                    \"range\",\r\n                    \"scrollbar\",\r\n                    \"separator\",\r\n                    \"slider\",\r\n                    \"spinbutton\"\r\n                ],\r\n                inherited: [\r\n                    \"progressbar\"\r\n                ]\r\n            },\r\n            \"aria-valuetext\": {\r\n                used: [\r\n                    \"range\",\r\n                    \"separator\"\r\n                ],\r\n                inherited: [\r\n                    \"progressbar\",\r\n                    \"scrollbar\",\r\n                    \"slider\",\r\n                    \"spinbutton\"\r\n                ]\r\n            }\r\n        });\r\n\r\n        /**\r\n         * If true, trying to set a WAI-ARIA attribute on an element without the\r\n         * correct role set will fail.\r\n         * @type {Boolean}\r\n         */\r\n        ARIA.failOnInvalidRole = false;\r\n\r\n        /**\r\n         * A warning message for the element not having the correct role.\r\n         * @type {String}\r\n         */\r\n        ARIA.WARNING_INVALID_ROLE = (\r\n            \"The '{0}' attribute should be applied to an element having one \" +\r\n            \"of these roles: {1}\"\r\n        );\r\n\r\n        /**\r\n         * A warning message for none of the element's parents having the\r\n         * correct role.\r\n         * @type {String}\r\n         */\r\n        ARIA.WARNING_INVALID_PARENT_ROLE = (\r\n            \"The '{0}' attribute should be applied to an element with a \" +\r\n            \"parent that has one of these roles: {1}\"\r\n        );\r\n\r\n        /**\r\n         * Converts an array of roles into a CSS selector matching any of them.\r\n         *\r\n         * @param  {Array.<String>} roles\r\n         *         Roles to convert into a CSS selector.\r\n         * @return {String}\r\n         *         CSS selector that matches any of the roles.\r\n         */\r\n        ARIA.makeRoleSelector = function (roles) {\r\n\r\n            return roles.map(function (role) {\r\n                return \"[role~=\\\"\" + role + \"\\\"]\";\r\n            }).join(\",\");\r\n\r\n        };\r\n\r\n        /**\r\n         * Gets the closest element to the given element which matches the given\r\n         * selector. The given element is the first one checked so it may be\r\n         * returned.\r\n         *\r\n         * @function\r\n         * @param    {Element} element\r\n         *           Starting element.\r\n         * @param    {String} selector\r\n         *           CSS selector of the element to find.\r\n         * @return   {Element|null}\r\n         *           Either the closest element or null if the element can't be\r\n         *           found.\r\n         */\r\n        ARIA.closest = (\r\n            Element.prototype.closest\r\n            ? function (element, selector) {\r\n                return element.closest(selector);\r\n            }\r\n            : function (element, selector) {\r\n\r\n                var closest = null;\r\n\r\n                while (\r\n                    element\r\n                    && element.nodeType === Node.ELEMENT_NODE\r\n                    && document.documentElement.contains(element)\r\n                ) {\r\n\r\n                    if (ARIA.is(element, selector)) {\r\n\r\n                        closest = element;\r\n                        break;\r\n\r\n                    }\r\n\r\n                    element = element.parentNode;\r\n\r\n                }\r\n\r\n                return closest;\r\n\r\n            }\r\n        );\r\n\r\n        /**\r\n         * Checks to see that the given element has the correct role(s) or\r\n         * parent role(s) to accept the given attribute.\r\n         *\r\n         * @param  {Element} element\r\n         *         Element to check.\r\n         * @param  {String} attribute\r\n         *         Attribute to check.\r\n         * @return {Boolean}\r\n         *         false if the element or parent does not have the correct role\r\n         *         and {@link ARIA.failOnInvalidRole} is set to true. In all\r\n         *         other cases, this will be true.\r\n         */\r\n        ARIA.isRoleValid = function (element, attribute) {\r\n\r\n            var validRoles = ARIA.acceptedRoles[attribute];\r\n            var isValid = true;\r\n            var selector = \"\";\r\n            var warning = \"\";\r\n            var closest = null;\r\n\r\n            if (validRoles && validRoles.length) {\r\n\r\n                selector = ARIA.makeRoleSelector(validRoles);\r\n\r\n                if (!ARIA.is(element, selector)) {\r\n                    warning = ARIA.WARNING_INVALID_ROLE;\r\n                } else {\r\n\r\n                    closest = ARIA.closest(element, selector);\r\n\r\n                    if (closest && closest !== element) {\r\n                        warning = ARIA.WARNING_INVALID_PARENT_ROLE;\r\n                    }\r\n\r\n                }\r\n\r\n                if (warning) {\r\n\r\n                    ARIA.warn(ARIA.supplant(warning, [\r\n                        attribute,\r\n                        \"'\" + validRoles.join(\"', '\") + \"'\"\r\n                    ]));\r\n\r\n                    if (ARIA.failOnInvalidRole) {\r\n                        isValid = false;\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n            return isValid;\r\n\r\n        };\r\n\r\n        // Add validation.\r\n        ARIA.on(ARIA.EVENT_PRE_SET, function (e) {\r\n\r\n            var detail = e.detail;\r\n\r\n            if (!ARIA.isRoleValid(detail.element, detail.attribute)) {\r\n                e.preventDefault();\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n}(window.ARIA));\r\n"],"file":"aria.tokens.validRole.js"}